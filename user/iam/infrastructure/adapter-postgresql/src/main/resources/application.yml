quarkus:
  # configure your datasource
  datasource:
    db-kind: postgresql
  
  hibernate-orm:
    # drop and create the database at startup (use `update` to only update the schema)
    
    default-schema: quarkus   
    schema-management:
        strategy: validate

"%dev":
  quarkus:
    flyway:
      baseline-on-migrate: true
      migrate-at-start: true
      create-schemas: true
      clean-at-start: false
      schemas: quarkus

quarkus:
  datasource:
    db-kind: postgresql

# ===================================================================
# üõ†Ô∏è ENTORNO DE DESARROLLO (mvn quarkus:dev)
# ===================================================================
"%dev":
  quarkus:
    datasource:
      db-kind: postgresql
   

    hibernate-orm:
      # Hibernate NO toca DDL, solo valida que tus scripts est√©n bien
      database:
        generation: none
      schema-management:
        strategy: validate
      default-schema: quarkus

    flyway:
      # ‚ò¢Ô∏è MODO NUCLEAR: Borra DB al iniciar (lo que pediste)
      clean-at-start: true
      migrate-at-start: true
      create-schemas: true
      schemas: quarkus
      # √ötil si desactivas clean-at-start temporalmente
      baseline-on-migrate: true 

# ===================================================================
# üöÄ ENTORNO DE PRODUCCI√ìN (Docker build / java -jar)
# ===================================================================
"%prod":
  quarkus:
    datasource:
      # Inyectadas por variables de entorno (Docker/K8s)
      username: ${DB_USER}
      password: ${DB_PASSWORD}
      jdbc:
        url: ${DB_URL}

    hibernate-orm:
      database:
        generation: none
      # Falla al iniciar si el c√≥digo Java no coincide con la DB real
      schema-management:
        strategy: validate
      default-schema: quarkus

    flyway:
      # üîí SEGURIDAD TOTAL: Nunca borrar datos en prod
      clean-at-start: false
      
      # Ejecuta migraciones pendientes (V__...) al arrancar el contenedor
      migrate-at-start: true
      
      # Verifica que nadie haya modificado scripts viejos (checksum)
      validate-on-migrate: true
      
      schemas: quarkus
      baseline-on-migrate: true
