# ==========================================
# TU CONFIGURACIÓN ACTUAL (Dev / Base)
# (La dejamos exactamente como la tenías en la imagen)
# ==========================================
quarkus:
  compose:
    devservices:
      follow-container-logs: true
      files: compose-devservices.yml

  keycloak:
    devservices:
      enabled: false
      follow-container-logs: true
    admin-client:
      server-url: http://localhost:8080  # Esto funciona en tu máquina

  log:
    category:
      level: ERROR

# ==========================================
# CORRECCIÓN SOLO PARA PRODUCCIÓN
# ==========================================
"%prod":
  quarkus:
    keycloak:
      admin-client:
        # IMPORTANTE: Sobrescribimos esto. Si no lo hacemos, 
        # intentará usar http://localhost:8080 del bloque de arriba y fallará.
        server-url: ${KEYCLOAK_INTERNAL_URL}
        tls-configuration-name: kc-mtls
    
    tls:
      kc-mtls:
        key-store:
          p12:
            path: certs/client-keystore.p12
            password: secret
        trust-store:
          p12:
            path: certs/client-truststore.p12
            password: secret

