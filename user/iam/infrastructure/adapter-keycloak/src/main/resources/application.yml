# ==========================================
# TU CONFIGURACIÓN ACTUAL (Dev / Base)
# (La dejamos exactamente como la tenías en la imagen)
# ==========================================
quarkus:
  compose:
    devservices:
      follow-container-logs: true
      files: compose-devservices.yml

  keycloak:
    devservices:
      enabled: true
      follow-container-logs: true
    admin-client:
      server-url: http://localhost:8080

  log:
    category:
      level: ERROR

# ==========================================
# CORRECCIÓN SOLO PARA PRODUCCIÓN
# ==========================================
"%prod":
  quarkus:
      # Si no usas client-id/secret para validar tokens, no los pongas aquí.
      # Solo auth-server-url basta para validar firmas JWT.

    keycloak:
      admin-client:
        # IMPORTANTE: Sobrescribimos esto. Si no lo hacemos, 
        # intentará usar http://localhost:8080 del bloque de arriba y fallará.
        server-url: ${KEYCLOAK_INTERNAL_URL}
        realm: master                # El realm donde vive el admin-cli
        client-id: admin-cli         # El cliente por defecto
        
        # -----------------------------------------------------
        # CAMBIOS CLAVE PARA USAR ADMIN-CLI POR DEFECTO:
        # -----------------------------------------------------
        
        # 1. Cambiamos el tipo de grant a PASSWORD
        grant-type: password         
        
        # 2. Usamos las credenciales del Super Admin (el humano)
        username: adminpds              # O el usuario que creaste al iniciar Keycloak
        password: adminpds
